<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en">

<head th:replace="@{/fragments/head} :: head"></head>

<body id="page-top" class="bg-dark bodyRegistrarOficio">
  <nav th:replace="@{/fragments/navbar} :: nav"></nav>

  <div th:replace="@{/fragments/thmsg} :: div"></div>

  <main class="container d-flex justify-content-center mb-5 pb-5">
    <div class="pt-4 mt-3 m-1 col-5">
      <form class="form bg-color text-white" th:action="@{/user/editprofile/__${session.usuariosession.id}__}" method="post" enctype="multipart/form-data">
        <input hidden th:value="${id}" name="id">
        <h4 class="text-color text-center">Editar Perfil</h4>
        <div class="contenedor">
          <div class="form-group text-white fw-semibold pt-2">
            <label for="name" class="ps-1 pb-1">Nombre:</label>
            <input class="form-control bg-dark text-white" type="text" name="name" th:value="${user.name}" placeholder="Nombre">
          </div>
          <div class="form-group text-white fw-semibold pt-3">
            <label for="password" class="ps-1 pb-1">Nueva contraseña:</label>
            <input class="form-control bg-dark text-white" type="password" name="password" placeholder="Contraseña">
          </div>
          <div class="form-group text-white fw-semibold pt-3">
            <input class="form-control bg-dark text-white" type="password" name="password2" placeholder="Repetir Contraseña">
          </div>
          <div class="form-group text-white pt-3 fw-semibold text-center d-flex flex-wrap justify-content-center">
            <label for="role" class="fw-semibold mb-2 fs-6 col-7">Seleccionar Rol:</label>
            <div class="mb-2 col-6">
              <select id="role" name="role" class="bg-dark text-white form-select form-select-md">
                <option value="client">Cliente</option>
                <option value="provider">Proveedor</option>
              </select>
            </div>
          </div>

          <div class="form-group text-white fw-semibold pt-3" id="wapDiv" style="display:none">
            <label for="password" class="ps-1 pb-1">Whatsapp:</label>
            <input type="number" name="whatsApp" class="form-control bg-dark text-white fw-semibold" placeholder="WhatsApp" autocomplete="off">
          </div>
          <div class="form-group text-white fw-semibold pt-3" id="imagenDiv" style="display:none">
            <label for="archivo" class="ps-1 pb-1">Foto de perfil:</label>
            <input type="file" accept="image/*" id="image" name="file" class="form-control bg-dark text-white" onchange="previewImage(event)">
            <img id="preview" src="" alt="Image Preview" style="max-width: 200px; max-height: 200px; display: none;">
          </div>

          <div class="form-group mx-sm-4 text-white pt-2 text-center" id="skillsDiv" style="display:none">
            <div class="form-group mx-sm-4 text-white pt-2 fw-semibold text-center">
              <label class="fw-semibold mb-2 fs-5">Seleccionar servicio/s</label>
              <!-- Agrega un div para mostrar mensajes de error -->
              <div id="mensajeError" style="color: red;"></div>
            </div>
            <div id="skills" style="height: 200px; overflow-y: auto;">
              <table class="table table-borderless table-hover table-striped table-dark">
                <!-- SUPRIMI LOS ENCABEZADOS DE SKILL PORQUE ERA REDUNDANTE -->
                <tbody>
                  <tr th:each="skill : ${skillsRegistro}">
                    <td th:text="${skill.name}"></td>
                    <td><input type="checkbox" name="skills" th:value="${skill.id}"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="form-group text-white fw-semibold pt-3 text-center">
            <button class="btn btn-primary mt-3 botones m-auto w-auto pt-2" type="submit">Guardar cambios</button>
            <button class="btn btnbuscar mt-3 botones m-auto w-auto pt-2" th:href="@{/}">Cancelar</button>
          </div>
        </div>
      </form>
    </div>
  </main>

  <footer th:replace="@{/fragments/footer} :: footer"></footer>
  <script th:replace="@{/fragments/script} :: script"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous">
    </script>

</body>

</html>